# ferromagnetic_issue
### Условие задачи

**Дано:**
- трехмерная решетка молекул, расположенных в узлах кристаллической решетки, размеров $L_x \times L_y \times L_z$ с периодическими границами
- каждая молекула обладает спином +1 или -1
- межмолекулярное взаимодействие описывается константами $J_{ij} = 1$
- модель Изинга


**Требуется:**
- согласно модели Изинга рассчитать нормированное значение средней энергии $\frac{\langle E \rangle}{L_x L_y L_z}$ для указанной решетки молекул при:
    - размерах решетки $L_x \in [2, 3, ..., 8], L_y = 2, L_z = 2$
    - температурах $kT \in [1.0, 10.0]$ с шагом $0.2$
- сохранить массив средних энергий при помощи `np.save`
- вывести время расчета каждой итерации по $L_x$ или по $kT$
- вывести нормированные значения средней энергии на экран (см. пример в разделе Проверка корректности результатов)
- отобразить **цветовую карту**, используя сохраненный массив:
    - ось абсцисс (`x`) - $L_x$,
    - ось ординат (`y`) - $k T$,
    - цветом отобразить нормированное значение средней энергии $\frac{\langle E \rangle}{L_x L_y L_z}$,
    - подписать оси,
    - отобразить цветовую шкалу (`colorbar`),
    - засечки должны соответствовать значениям $L_x, kT$.
- отобразить **график**, используя сохраненный массив:
  - при $L_x = 4$
  - ось абсцисс (`x`) - $k T$
  - ось ординат - нормированное значение средней энергии $\frac{\langle E \rangle}{L_x L_y L_z}$
- к каждой функции добавить `docstring` с описанием того, что функция делает, всех параметров и возвращаемого значения; cм. [docstring-formats](https://realpython.com/documenting-python-code/#docstring-formats)   

**Описание:**

**Одномерный случай**

Модель Изинга является моделью магнетика. Пусть этот магнетик состоит из молекул, расположенных в узлах регулярной решетки. Пусть всего таких узлов будет $N$ штук, с индексами $i=1,\ldots, N$.

Предположим, что каждая молекула может быть представлена в виде магнитной стрелки, которая всегда либо направлена вдоль некоторой заданной оси, либо в противоположном направлении. То есть каждая молекула $i$ имеет две конфигурации, которые можно описывать с помощью "спиновой" переменной $\sigma_i$. Эта переменная принимает значение $+1$ (параллельно оси, спин направлен вверх) и $-1$ (антипараллельно оси, спин направлен вниз).

Пусть $\sigma = \{\sigma_1, \sigma_2, \ldots, \sigma_N\}$ обозначает набор значений всех $N$ спинов. Имеется $2^N$ различных наборов $\sigma$, и каждый из них описывает некоторое состояние системы.

Гамильтониан системы  состоит из двух частей: первая $E_0$ включает вклад межмолекулярных сил внутри магнетика, а вторая $E_1(\sigma)$ вклад от взаимодействий каждого спина с внешним магнитным полем (здесь считается нулевым).
$$H(\sigma)=E_0(\sigma)+E_1(\sigma)$$

В любой физической системе мы предполагаем все взаимодействия инвариантными по отношению к обращению времени, что означает инвариантность $E$ при изменении знаков всех полей и намагниченностей. Энергия должна быть четной функцией от $\sigma$:
$$E_0(\sigma_1,\ldots, \sigma_N)=E_0(-\sigma_1,\ldots, -\sigma_N)$$

Энергия системы при нулевом внешнем магнитном поле равна сумме произведений **соседних** спинов на константы взаимодействия $J_{ij}$
$$E(\sigma) = -\sum_{i} J_{i,i+1}\sigma_{i}\sigma_{i+1} $$

Вероятность находиться в состоянии $\sigma$
$$P(\sigma)=\frac{e^{-\beta E(\sigma)}}{Z},$$
	где $Z = \sum_{\sigma} e^{-\beta E(\sigma)}-$ статистическая сумма, $\beta = \frac{1}{k T}-$ обратная температура, $k-$ константа Больцмана.

Средняя энергия системы
$$\langle E \rangle = \frac{1}{Z}\sum_{\{\sigma \}} E(\sigma)e^{-\frac{E(\sigma)}{kT}}$$
рассчитывается по всевозможным состояниям системы, т.е. всевозможным наборам $\sigma$.

**Двумерный случай**

В случае двумерной решетки энергия системы при нулевом внешнем магнитном поле вычисляется следующим образом:
$$E(\sigma) = -\sum_{i,j} J_{ij}(\sigma_{i,j}\sigma_{i+1,j} + \sigma_{i,j}\sigma_{i,j+1})$$

**Трехмерный случай**

В случае трехмерной решетки энергия системы при нулевом внешнем магнитном поле вычисляется следующим образом:
$$E(\sigma) = -\sum_{i,j,k} J_{ijk}(\sigma_{i,j,k}\sigma_{i+1,j,k} + \sigma_{i,j,k}\sigma_{i,j+1,k} + \sigma_{i,j,k}\sigma_{i,j,k+1})$$

**Проверка корректности результатов**

Нормированное значение средней энергии при температурах $kT \in [1.0, 10.0]$:

- для $L_x=4$

```
 -2.9999245  -2.99942704 -2.99751294 -2.99234641 -2.98120832 -2.96055993
 -2.92624559 -2.8739877  -2.80028775 -2.70359717 -2.58527526 -2.4497323
 -2.30352171 -2.15378271 -2.00677809 -1.86706074 -1.73733502 -1.61876535
 -1.51143987 -1.41479962 -1.32795939 -1.24991655 -1.17967258 -1.11629579
 -1.05894797 -1.00689072 -0.9594814  -0.91616422 -0.87645988 -0.8399552
 -0.80629365 -0.77516695 -0.74630779 -0.71948375 -0.69449204 -0.67115517
 -0.64931722 -0.62884085 -0.6096046  -0.5915008  -0.57443364 -0.55831768
 -0.54307645 -0.52864137 -0.51495073 -0.50194891
```

- для $L_x=5$

```
 -2.99992424 -2.99942279 -2.99747931 -2.99217771 -2.98058943 -2.95875848
 -2.92188438 -2.86496311 -2.78406936 -2.67801634 -2.54952834 -2.40498666
 -2.25267579 -2.10053598 -1.95459576 -1.81851387 -1.69392282 -1.58106528
 -1.47938363 -1.38794061 -1.30567554 -1.2315422  -1.16457336 -1.10390466
 -1.04877746 -0.99853208 -0.95259735 -0.91047935 -0.8717507  -0.83604105
 -0.8030287  -0.77243351 -0.74401083 -0.71754637 -0.69285189 -0.66976157
 -0.64812887 -0.62782395 -0.60873144 -0.59074855 -0.57378347 -0.55775396
 -0.5425862  -0.52821375 -0.51457668 -0.5016208
```

**Материалы:**
- [Бэкстер Р., Вольский Е. П., Дайхин Л. И. Точно решаемые модели в статистической механике](https://yadi.sk/i/2oY4c0bL08pNiw)
- [Пример хорошего `docstring`](https://github.com/numpy/numpy/blob/v1.21.0/numpy/linalg/linalg.py#L313-L395)
- [Зиннуров Б.Д., Якименко В.Я. Магнитные свойства модели Изинга в низких размерностях (МКР)](https://miem.hse.ru/data/2018/05/24/1149431665/model_Izinga_-_Zinnurov_Yakimenko.pdf)
- [docstring-formats](https://realpython.com/documenting-python-code/#docstring-formats)



- итоговая оценка за задание = $\sum_{Lx=2}^{8}{g(Lx)} - \sum_{i}{p(i)}$
